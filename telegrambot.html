<!-- index.html -->

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>React Tutorial</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.2.1/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.2.1/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/remarkable/1.6.2/remarkable.min.js"></script>
    <script src="../_js/jquery-1.7.2.min.js"></script>
    <script>
                                </script>
      <script type="text/babel">
      </script>
  </head>
  <body>
    <div id="zoom"></div>
    <script type="text/babel">
        var par = new Promise(function(resolve,reject) {
             $.ajax({
		    type: "POST",
		    dataType: 'jsonp',
		    url: "https://api.novaposhta.ua/v2.0/json/",
		data: {
			      "modelName": "Address",
		      "calledMethod": "getCities",
		      "methodProperties": {}, 
		      "apiKey": "6f94a6391cb5134ee68ddb7924de2a3d"
		    
		},
			  success: function(msg) { 
                  resolve(msg);
                }
            });
        });
var ItemCity = React.createClass({
	render() { return(<div> {this.props.name} </div>) }
})
var Item = React.createClass({
	render: function() {
		return <li> I mad {this.props.name} </li>;
	}
})
var arry = ['kolon', 'petrol', 'turel'];
var ContactsList = React.createClass({
	render: function() {
		return (
				<div>
				{
					arry.map(function(el){
						return <Item name={el} />
					})
				}
				</div>
		       )
	}
})
var CITY;
    par.then(function(nameCity){
	    var CITY = nameCity.data.map(function(doIt) {
		    return doIt.DescriptionRu.toLowerCase()
	    })
var Kura = React.createClass({
	getInitialState: function() {
		return( 
				{kek: '', valu: ''}
		      )
	},
    handleChange(event) {
        console.log(event.target.value)
        this.setState({valu: event.target.value});
	var enteredNameCity = event.target.value;
    if(event.target.value.length<1) {
        enteredNameCity = 0;
    }
	var varitifyCity = CITY.filter(function(dta) {
	      	return (dta.indexOf(enteredNameCity) !== -1 && dta.indexOf(enteredNameCity) == 0);
	}
			)
		var ListTown = varitifyCity.map(function(data){
			return <Item name={data} />
		})
	this.setState({kek: ListTown})
},
	chooseCity: function(data) {
		this.setState({kek:'', valu:data.target.innerText})
		console.log('gogog')
	},
	render: function() {
		return(

            <div>
            <form >
	    <input type="text" value={this.state.valu} onChange={this.handleChange}/>
	    <div onClick={this.chooseCity}> {this.state.kek} </div>
            </form>
            </div>
		      ) 
	}
})
ReactDOM.render(
    <Kura />,
    document.getElementById('zoom')
    )
    })
    </script>
  </body>
</html>
